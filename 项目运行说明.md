# 2020-DBMS-project

## 项目架构

```
|-- project
    |-- 04_proj_task2_report.md
    |-- 项目运行说明.md
    |-- src
        |-- data_page.cpp
        |-- main.cpp
        |-- makefile
        |-- pm_ehash.cpp
        |-- ycsb.cpp
    |-- asset
        |-- PmEHash.bmp
    |-- data
    |-- gtest
    |-- images
        |-- gtest.png
        |-- ycsb.png
    |-- include
        |-- data_page.h
        |-- pm_ehash.h
    |-- test
    |-- workloads

```

## ycsb运行说明

**请注意，所有的操作请在root模式下进行。**

### 生成测试数据集

**workloads**目录下，执行

```
./data_generator 文件名前缀 初始数据数量 操作次数 数据最大值
```

例如执行    

```
./data_generator test 1000000 2000000 10000
```  
会生成    
1000000个初始数据到**test-load.txt**    
2000000个操作到**test-run.txt**    
数据范围都是1-10000    

### 运行ycsb

进入**src**目录执行

```
make ycsb
./ycsb test
```

就会将 **../workloads/test-load.txt** 和 **../workloads/test-run.txt** 的数据进行测试    

## gtest运行说明

进入 **/mnt/pmemdir** 文件夹下执行    

```
mkdir data
```

来创建本次实验需要的持久数据目录。  
进入**test**文件夹下,执行

```
make
./bin/ehash_test
```

即可看到运行结果
